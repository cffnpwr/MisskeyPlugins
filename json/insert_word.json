{
  "type": "plugin",
  "data": "/// @ 0.19.0\n### {\n  id: \"01f6a732-8905-5464-745e-caba207ba14e\"\n  name: \"入力されている文字、1文字ずつに『特定の文字』を追加するプラグイン\"\n  version: \"1.0.0\"\n  author: \"elysion\"\n  description: \"投稿メニューに【変換：1文字ずつに特定の文字を追加】を追加します。\"\n  config: {\n    insertString: {\n      type: \"string\"\n      label: \"1文字以上は1文字目が適用されます\"\n      description: \"既定値：゛\"\n      default: \"゛\"\n    }\n  }\n}\n\nlet c = {}\nc.insertString = Plugin:config.insertString\nif c.insertString.len == 0 {\n  Mk:dialog(\"エラー\", [\n    `挿入する文字がありません。`\n    `既定値の **゛** が適用されます。`\n  ].join(Str:lf), \"warning\")\n} else if c.insertString.len > 1 {\n  c.insertString = c.insertString.pick(0)\n  Mk:dialog(\"エラー\", [\n    `挿入する文字が1文字以上です。`\n    `自動で一文字目の **{c.insertString}** が適用されます。`\n  ].join(Str:lf), \"warning\")\n}\n\nPlugin:register_post_form_action(`変換：1文字ずつに『{c.insertString}』を追加`, @(form, update) {\n  let conv_text = form.text.split().map(@(v) {\n    if v != Str:lf `{v}{c.insertString}` else v\n  })\n\n  update(\"text\", conv_text.join())\n})"
}
